"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _params=_interopRequireDefault(require("./params.js"));Object.defineProperty(exports,"__esModule",{value:!0}),exports.encrypt=encrypt,exports.decrypt=decrypt;/**
 * nodeapi.js
 */function encrypt(a,b,c,d){var e=c.name,f=void 0===e?"AES-GCM":e,g=c.iv,h=c.additionalData,i=c.tagLength,j=_params.default.ciphers[f].nodePrefix;j="".concat(j,"-").concat((8*b.byteLength).toString(),"-"),j+=_params.default.ciphers[f].nodeSuffix;var k;"AES-GCM"===f&&(k=d.createCipheriv(j,b,g,{authTagLength:i}),k.setAAD(h));var l=new Uint8Array(k.update(a)),m=new Uint8Array(k.final()),n=new Uint8Array([]);"AES-GCM"===f&&(n=new Uint8Array(k.getAuthTag()));var o=new Uint8Array(l.length+m.length+n.length);return o.set(l),o.set(m,l.length),o.set(n,l.length+m.length),o}function decrypt(a,b,c,d){var e=c.name,f=void 0===e?"AES-GCM":e,g=c.iv,h=c.additionalData,i=c.tagLength,j=_params.default.ciphers[f].nodePrefix;j="".concat(j,"-").concat((8*b.byteLength).toString(),"-"),j+=_params.default.ciphers[f].nodeSuffix;var k,l;if("AES-GCM"===f){k=d.createDecipheriv(j,b,g,{authTagLength:i}),k.setAAD(h),l=a.slice(0,a.length-i);var p=a.slice(a.length-i);k.setAuthTag(p)}var m,n=k.update(l);try{m=k.final()}catch(a){throw new Error("DecryptionFailure")}var o=new Uint8Array(m.length+n.length);return o.set(n),o.set(m,n.length),o}